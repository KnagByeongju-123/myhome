<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚˜ì˜ í´ë¼ìš°ë“œ í™ˆí˜ì´ì§€</title>
    <style>
        /* --- CSS ìŠ¤íƒ€ì¼ ì˜ì—­ --- */
        :root {
            --primary-color: #3b82f6;
            --text-color: #333;
            --bg-color: #f8f9fa;
            --header-height: 60px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif; 
            line-height: 1.6; 
            color: var(--text-color);
            background-color: var(--bg-color);
            padding-top: var(--header-height);
        }
        a { text-decoration: none; color: inherit; cursor: pointer;}
        button { font-family: inherit; }

        /* ë¡œë”© ë°” */
        #loading {
            position: fixed; top: 0; left: 0; width: 100%; height: 3px;
            background: linear-gradient(to right, var(--primary-color), #60a5fa);
            z-index: 9999; display: none;
            animation: loadingBar 2s infinite;
        }
        @keyframes loadingBar { 0% { width: 0; } 50% { width: 70%; } 100% { width: 100%; } }

        /* í—¤ë” */
        header {
            position: fixed; top: 0; left: 0; width: 100%; height: var(--header-height);
            background-color: #ffffff; border-bottom: 1px solid #ddd;
            z-index: 1000; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .header-inner {
            max-width: 1000px; margin: 0 auto; height: 100%;
            display: flex; justify-content: space-between; align-items: center; padding: 0 20px;
        }
        .logo { font-weight: bold; font-size: 1.2rem; color: var(--primary-color); }
        .nav-container { display: flex; gap: 20px; }
        .nav-link {
            padding: 8px 12px; border-radius: 4px; font-size: 0.95rem; color: #666; transition: all 0.2s;
        }
        .nav-link:hover { background-color: #f0f0f0; color: var(--primary-color); }
        .nav-link.active { color: var(--primary-color); font-weight: bold; background-color: #eff6ff; }

        /* ë©”ì¸ ì»¨í…ì¸  */
        .main-container {
            max-width: 1000px; margin: 0 auto; padding: 40px 20px;
            min-height: calc(100vh - var(--header-height));
        }
        .content-section { display: none; animation: fadeIn 0.3s ease-in-out; }
        .content-section.show { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h2 {
            font-size: 2rem; margin-bottom: 20px; color: #111;
            border-bottom: 2px solid var(--primary-color); display: inline-block; padding-bottom: 5px;
        }

        /* ê²Œì‹œíŒ ìŠ¤íƒ€ì¼ */
        .board-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .btn-primary {
            padding: 8px 16px; background: var(--primary-color); color: white;
            border: none; border-radius: 4px; cursor: pointer; font-weight: 500;
            transition: background 0.2s;
        }
        .btn-primary:hover { background-color: #2563eb; }
        .btn-primary:disabled { background-color: #ccc; cursor: not-allowed; }

        .board-table {
            width: 100%; border-collapse: collapse; background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden; table-layout: fixed;
        }
        .board-table th, .board-table td {
            padding: 12px 15px; text-align: left; border-bottom: 1px solid #eee;
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        .board-table th { background-color: #f8fafc; font-weight: 600; color: #444; }
        .board-table tr:hover { background-color: #f8f9fa; }
        
        .col-no { width: 60px; text-align: center; }
        .col-title { width: auto; }
        .col-author { width: 100px; text-align: center; }
        .col-date { width: 120px; text-align: center; }
        .col-views { width: 70px; text-align: center; }
        .post-title { cursor: pointer; color: #1f2937; }
        .post-title:hover { text-decoration: underline; color: var(--primary-color); }

        /* ê°¤ëŸ¬ë¦¬ ìŠ¤íƒ€ì¼ */
        .gallery-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px;
        }
        .gallery-item {
            background: white; border-radius: 8px; overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: transform 0.2s;
        }
        .gallery-item:hover { transform: translateY(-5px); }
        .gallery-img-box {
            width: 100%; height: 160px; background-color: #eee;
            overflow: hidden; display: flex; align-items: center; justify-content: center;
        }
        .gallery-img-box img { width: 100%; height: 100%; object-fit: cover; }
        .gallery-caption { padding: 12px; font-size: 0.95rem; text-align: center; border-top: 1px solid #f0f0f0; }

        /* ëª¨ë‹¬ (íŒì—…) ìŠ¤íƒ€ì¼ */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 2000; align-items: center; justify-content: center;
        }
        .modal-overlay.open { display: flex; }
        .modal-box {
            background: white; width: 90%; max-width: 500px; padding: 25px;
            border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); position: relative;
            max-height: 90vh; overflow-y: auto;
        }
        .modal-header { font-size: 1.25rem; font-weight: bold; margin-bottom: 15px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .modal-close {
            position: absolute; top: 20px; right: 20px; background: none; border: none;
            font-size: 1.5rem; cursor: pointer; color: #999;
        }
        .form-group { margin-bottom: 15px; }
        .form-label { display: block; margin-bottom: 5px; font-weight: 600; font-size: 0.9rem; }
        .form-input, .form-textarea {
            width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem;
        }
        .form-textarea { height: 150px; resize: vertical; }
        .post-view-content { background: #f9f9f9; padding: 15px; border-radius: 4px; min-height: 100px; white-space: pre-wrap; }
        .post-view-meta { color: #666; font-size: 0.9rem; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; }

        /* ëª¨ë°”ì¼ ëŒ€ì‘ */
        @media (max-width: 600px) {
            .header-inner { flex-direction: column; height: auto; padding: 10px; }
            header { height: auto; position: relative; }
            body { padding-top: 0; }
            .nav-container { margin-top: 10px; width: 100%; overflow-x: auto; }
            .col-date, .col-views { display: none; }
            .board-table td:nth-child(4), .board-table td:nth-child(5) { display: none; }
        }
    </style>
</head>
<body>
    <div id="loading"></div>

    <header>
        <div class="header-inner">
            <div class="logo">My Cloud Home</div>
            <nav class="nav-container" id="nav-menu"></nav>
        </div>
    </header>

    <div class="main-container">
        
        <!-- 1. í™ˆ ì„¹ì…˜ -->
        <section id="home" class="content-section show">
            <h2>í™˜ì˜í•©ë‹ˆë‹¤! â˜ï¸</h2>
            <p>ì´ í™ˆí˜ì´ì§€ëŠ” <strong>êµ¬ê¸€ ì‹œíŠ¸</strong>ì™€ <strong>êµ¬ê¸€ ë“œë¼ì´ë¸Œ</strong>ë¥¼ DBë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
            <div style="margin-top: 30px; padding: 20px; background: white; border-radius: 8px; border-left: 4px solid var(--primary-color); box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                <h3>ğŸ“Œ ì‹œìŠ¤í…œ ì—°ê²° ìƒíƒœ</h3>
                <ul style="margin-top: 10px; padding-left: 20px; list-style: disc;" id="system-status">
                    <li>ì—°ë™ ìƒíƒœ í™•ì¸ ì¤‘...</li>
                </ul>
            </div>
            <p style="margin-top:20px; color:#666; font-size:0.9rem;">
                * ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹œê°„ì´ ì¡°ê¸ˆ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤ (êµ¬ê¸€ ë¬´ë£Œ ì„œë²„ íŠ¹ì„±).
            </p>
        </section>

        <!-- 2. í”„ë¡œí•„ ì„¹ì…˜ -->
        <section id="profile" class="content-section">
            <h2>í”„ë¡œí•„</h2>
            <div style="display: flex; gap: 20px; align-items: center;">
                <div style="width: 100px; height: 100px; background: #eee; border-radius: 50%; display:flex; align-items:center; justify-content:center; font-size:2rem;">ğŸ˜Š</div>
                <div>
                    <h3>í™ê¸¸ë™</h3>
                    <p>êµ¬ê¸€ í´ë¼ìš°ë“œ ì—°ë™ í™ˆí˜ì´ì§€ì…ë‹ˆë‹¤.</p>
                    <p>ê²Œì‹œíŒ ê¸€ì€ êµ¬ê¸€ ì‹œíŠ¸ì—, ì‚¬ì§„ì€ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì €ì¥ë©ë‹ˆë‹¤.</p>
                </div>
            </div>
        </section>

        <!-- 3. ê²Œì‹œíŒ ì„¹ì…˜ -->
        <section id="board" class="content-section">
            <div class="board-controls">
                <h2>ììœ  ê²Œì‹œíŒ</h2>
                <button class="btn-primary" onclick="openWriteModal()">âœï¸ ê¸€ì“°ê¸°</button>
            </div>
            <table class="board-table">
                <thead>
                    <tr>
                        <th class="col-no">ë²ˆí˜¸</th>
                        <th class="col-title">ì œëª©</th>
                        <th class="col-author">ì‘ì„±ì</th>
                        <th class="col-date">ì‘ì„±ì¼</th>
                        <th class="col-views">ì¡°íšŒ</th>
                    </tr>
                </thead>
                <tbody id="board-list-body">
                    <!-- ë°ì´í„° ë¡œë“œ ì „ í‘œì‹œ -->
                    <tr><td colspan="5" style="text-align:center; padding:20px;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</td></tr>
                </tbody>
            </table>
        </section>

        <!-- 4. ê°¤ëŸ¬ë¦¬ ì„¹ì…˜ -->
        <section id="gallery" class="content-section">
            <div class="board-controls">
                <h2>ë“œë¼ì´ë¸Œ ê°¤ëŸ¬ë¦¬</h2>
                <button class="btn-primary" onclick="openGalleryModal()">ğŸ“· ì‚¬ì§„ ì—…ë¡œë“œ</button>
            </div>
            <p style="font-size:0.9rem; color:#666; margin-bottom:15px;">* êµ¬ê¸€ ë“œë¼ì´ë¸Œ í´ë”ì˜ ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.</p>
            <div class="gallery-grid" id="gallery-container">
                <p style="grid-column: 1/-1; text-align: center;">ê°¤ëŸ¬ë¦¬ ë¡œë”© ì¤‘...</p>
            </div>
        </section>

    </div>

    <!-- === ëª¨ë‹¬(íŒì—…) ì˜ì—­ === -->

    <!-- ê¸€ì“°ê¸° ëª¨ë‹¬ -->
    <div id="modal-write" class="modal-overlay">
        <div class="modal-box">
            <button class="modal-close" onclick="closeModal('modal-write')">&times;</button>
            <div class="modal-header">ìƒˆ ê¸€ ì‘ì„±</div>
            <div class="form-group">
                <label class="form-label">ì‘ì„±ì</label>
                <input type="text" id="input-author" class="form-input" placeholder="ì´ë¦„">
            </div>
            <div class="form-group">
                <label class="form-label">ì œëª©</label>
                <input type="text" id="input-title" class="form-input" placeholder="ì œëª©">
            </div>
            <div class="form-group">
                <label class="form-label">ë‚´ìš©</label>
                <textarea id="input-content" class="form-textarea" placeholder="ë‚´ìš©"></textarea>
            </div>
            <button class="btn-primary" style="width: 100%;" onclick="savePost()" id="btn-save-post">ì €ì¥í•˜ê¸°</button>
        </div>
    </div>

    <!-- ê¸€ë³´ê¸° ëª¨ë‹¬ -->
    <div id="modal-view" class="modal-overlay">
        <div class="modal-box">
            <button class="modal-close" onclick="closeModal('modal-view')">&times;</button>
            <div class="modal-header" id="view-title">ì œëª©</div>
            <div class="post-view-meta" id="view-meta">ì‘ì„±ì | ë‚ ì§œ</div>
            <div class="post-view-content" id="view-content">ë‚´ìš©</div>
            <div style="margin-top: 20px; text-align: right;">
                <button class="btn-primary" style="background-color: #64748b;" onclick="closeModal('modal-view')">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <!-- ì‚¬ì§„ ì—…ë¡œë“œ ëª¨ë‹¬ -->
    <div id="modal-gallery" class="modal-overlay">
        <div class="modal-box">
            <button class="modal-close" onclick="closeModal('modal-gallery')">&times;</button>
            <div class="modal-header">êµ¬ê¸€ ë“œë¼ì´ë¸Œ ì—…ë¡œë“œ</div>
            <p style="font-size:0.85rem; color:#666; margin-bottom:10px;">* ì—…ë¡œë“œ ì‹œ êµ¬ê¸€ ë“œë¼ì´ë¸Œ í´ë”ì— ì €ì¥ë©ë‹ˆë‹¤.</p>
            <div class="form-group">
                <label class="form-label">ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ</label>
                <input type="file" id="input-img-file" class="form-input" accept="image/*">
            </div>
            <button class="btn-primary" style="width: 100%;" onclick="uploadImage()" id="btn-upload-img">ì—…ë¡œë“œ (ì‹œê°„ ì†Œìš”ë¨)</button>
        </div>
    </div>

    <script>
        // ============================================================
        // [ì„¤ì •] ì œê³µí•´ì£¼ì‹  êµ¬ê¸€ ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ ë°°í¬ URLì…ë‹ˆë‹¤.
        const APP_API_URL = "https://script.google.com/macros/s/AKfycbyOjYEtAlCm8drpFjoIfNanRaJfHWdWkS3nQHmXLXGVQivqaNWz776NqfpVB4B4jGlH9A/exec";
        // ============================================================

        // ì´ˆê¸°í™” ë°ì´í„°
        const menuItems = [
            { id: 'home', label: 'í™ˆ' },
            { id: 'profile', label: 'í”„ë¡œí•„' },
            { id: 'board', label: 'ê²Œì‹œíŒ' },
            { id: 'gallery', label: 'ê°¤ëŸ¬ë¦¬' }
        ];
        let posts = [];
        let galleryItems = [];

        // ë¬¸ì„œ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', () => {
            createNavigationMenu();
            checkConnectionAndFetch();
        });

        // 1. ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ ìƒì„±
        function createNavigationMenu() {
            const navContainer = document.getElementById('nav-menu');
            navContainer.innerHTML = '';
            menuItems.forEach((item, index) => {
                const link = document.createElement('a');
                link.textContent = item.label;
                link.className = 'nav-link';
                if (index === 0) link.classList.add('active');
                
                link.onclick = (e) => { 
                    e.preventDefault(); 
                    switchTab(item.id, link); 
                };
                navContainer.appendChild(link);
            });
        }

        // 2. íƒ­ ì „í™˜
        function switchTab(targetId, clickedLink) {
            document.querySelectorAll('.nav-link').forEach(nav => nav.classList.remove('active'));
            clickedLink.classList.add('active');

            document.querySelectorAll('.content-section').forEach(sec => sec.classList.remove('show'));
            document.getElementById(targetId).classList.add('show');

            // ê²Œì‹œíŒì´ë‚˜ ê°¤ëŸ¬ë¦¬ íƒ­ì„ ëˆ„ë¥´ë©´ ìµœì‹  ë°ì´í„° ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸° (ì„ íƒì‚¬í•­)
            // if (targetId === 'board' || targetId === 'gallery') fetchAllData(); 
        }

        // 3. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (API í†µì‹ )
        async function checkConnectionAndFetch() {
            const statusEl = document.getElementById('system-status');
            
            if (!APP_API_URL) {
                statusEl.innerHTML = `<li style="color:red;">âš ï¸ API URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</li>`;
                return;
            }

            statusEl.innerHTML = `<li style="color:blue;">ğŸ“¡ êµ¬ê¸€ ì„œë²„ì™€ í†µì‹  ì¤‘...</li>`;
            
            await fetchAllData();
        }

        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        async function fetchAllData() {
            showLoading(true);
            try {
                // ë³‘ë ¬ë¡œ ìš”ì²­ (ê²Œì‹œê¸€, ê°¤ëŸ¬ë¦¬ ë™ì‹œì—)
                const [postRes, galRes] = await Promise.all([
                    fetch(APP_API_URL + '?action=getPosts'),
                    fetch(APP_API_URL + '?action=getImages')
                ]);

                posts = await postRes.json();
                galleryItems = await galRes.json();

                renderBoard();
                renderGallery();

                document.getElementById('system-status').innerHTML = 
                    `<li style="color:green;">âœ… ë™ê¸°í™” ì™„ë£Œ!</li>
                     <li>ê²Œì‹œê¸€: ${posts.length}ê°œ</li>
                     <li>ê°¤ëŸ¬ë¦¬: ${galleryItems.length}ì¥</li>`;

            } catch (e) {
                console.error(e);
                document.getElementById('system-status').innerHTML = 
                    `<li style="color:red;">âŒ ì—°ê²° ì‹¤íŒ¨: ${e.message}</li>`;
                alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì¸í„°ë„· ì—°ê²°ì´ë‚˜ ë°°í¬ ì£¼ì†Œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
            } finally {
                showLoading(false);
            }
        }

        // 4. ê²Œì‹œíŒ ê¸°ëŠ¥
        function renderBoard() {
            const tbody = document.getElementById('board-list-body');
            tbody.innerHTML = '';

            if (posts.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align:center; padding:20px;">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }

            posts.forEach(post => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="col-no">${post.no}</td>
                    <td class="col-title"><span class="post-title" onclick="viewPost(${post.no})">${post.title}</span></td>
                    <td class="col-author">${post.author}</td>
                    <td class="col-date">${post.date}</td>
                    <td class="col-views">${post.views}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        async function savePost() {
            const title = document.getElementById('input-title').value;
            const author = document.getElementById('input-author').value;
            const content = document.getElementById('input-content').value;

            if (!title || !author || !content) return alert('ëª¨ë“  ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');

            const btn = document.getElementById('btn-save-post');
            btn.disabled = true; 
            btn.textContent = 'ì €ì¥ ì¤‘...';

            try {
                // POST ìš”ì²­ ë³´ë‚´ê¸°
                // ì£¼ì˜: êµ¬ê¸€ ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ ì›¹ì•±ì€ CORS ì •ì±…ìƒ text/plainìœ¼ë¡œ ë³´ë‚´ëŠ” ê²ƒì´ ì•ˆì „í•  ë•Œê°€ ë§ìŒ
                await fetch(APP_API_URL, {
                    method: 'POST',
                    body: JSON.stringify({ 
                        action: 'savePost', 
                        title: title, 
                        author: author, 
                        content: content 
                    })
                });

                alert('ê²Œì‹œê¸€ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                closeModal('modal-write');
                
                // ì…ë ¥ì°½ ì´ˆê¸°í™”
                document.getElementById('input-title').value = '';
                document.getElementById('input-content').value = '';
                
                // ëª©ë¡ ê°±ì‹ 
                fetchAllData(); 

            } catch(e) {
                alert('ì €ì¥ ì‹¤íŒ¨: ' + e.message);
            } finally {
                btn.disabled = false; 
                btn.textContent = 'ì €ì¥í•˜ê¸°';
            }
        }

        function viewPost(no) {
            const post = posts.find(p => p.no == no);
            if (!post) return;
            document.getElementById('view-title').textContent = post.title;
            document.getElementById('view-meta').textContent = `ì‘ì„±ì: ${post.author} | ë‚ ì§œ: ${post.date}`;
            document.getElementById('view-content').textContent = post.content;
            document.getElementById('modal-view').classList.add('open');
        }

        // 5. ê°¤ëŸ¬ë¦¬ ê¸°ëŠ¥
        function renderGallery() {
            const container = document.getElementById('gallery-container');
            container.innerHTML = '';

            if (galleryItems.length === 0) {
                container.innerHTML = '<p style="grid-column: 1/-1; text-align: center;">ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            galleryItems.forEach(item => {
                const div = document.createElement('div');
                div.className = 'gallery-item';
                div.innerHTML = `
                    <div class="gallery-img-box">
                        <img src="${item.url}" alt="${item.caption}" loading="lazy" onerror="this.src='https://via.placeholder.com/300?text=No+Image'">
                    </div>
                    <div class="gallery-caption">${item.caption}</div>
                `;
                container.appendChild(div);
            });
        }

        async function uploadImage() {
            const fileInput = document.getElementById('input-img-file');
            if (fileInput.files.length === 0) return alert('íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
            
            const file = fileInput.files[0];
            const btn = document.getElementById('btn-upload-img');
            
            btn.disabled = true; 
            btn.textContent = 'ì—…ë¡œë“œ ì¤‘... (ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”)';

            // íŒŒì¼ì„ Base64ë¡œ ë³€í™˜
            const reader = new FileReader();
            reader.onload = async function(e) {
                const base64Data = e.target.result; // "data:image/png;base64,..." í˜•íƒœ
                
                try {
                    await fetch(APP_API_URL, {
                        method: 'POST',
                        body: JSON.stringify({
                            action: 'uploadImage',
                            fileName: file.name,
                            mimeType: file.type,
                            fileData: base64Data
                        })
                    });

                    alert('ì—…ë¡œë“œ ì™„ë£Œ! ê°¤ëŸ¬ë¦¬ê°€ ê³§ ê°±ì‹ ë©ë‹ˆë‹¤.');
                    closeModal('modal-gallery');
                    fileInput.value = ''; // ì´ˆê¸°í™”
                    fetchAllData();

                } catch(err) {
                    alert('ì—…ë¡œë“œ ì‹¤íŒ¨: ' + err.message);
                } finally {
                    btn.disabled = false; 
                    btn.textContent = 'ì—…ë¡œë“œ (ì‹œê°„ ì†Œìš”ë¨)';
                }
            };
            reader.readAsDataURL(file);
        }

        // 6. ëª¨ë‹¬ ê³µí†µ í•¨ìˆ˜
        function openWriteModal() { document.getElementById('modal-write').classList.add('open'); }
        function openGalleryModal() { document.getElementById('modal-gallery').classList.add('open'); }
        function closeModal(id) { document.getElementById(id).classList.remove('open'); }
        
        // ëª¨ë‹¬ ë°”ê¹¥ í´ë¦­ ì‹œ ë‹«ê¸°
        window.onclick = function(event) {
            if (event.target.classList.contains('modal-overlay')) {
                event.target.classList.remove('open');
            }
        }
    </script>
</body>
</html>
